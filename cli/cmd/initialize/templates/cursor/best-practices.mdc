---
description: Best Practices for Rill Development
globs:
alwaysApply: false
---
# Rill Development Best Practices

## Core Concepts

Rill is a "business intelligence as code" platform. Key resource types:
- **Models**: SQL that produces a table (DuckDB or Clickhouse)
- **Metrics views**: Queryable dimensions and measures based on a single model
- **Dashboard**: A metrics view (Rill auto-generates the UI)

Resource dependency: Metrics views â†’ Models. Multiple metrics views can use one model.

## Development Approach

- Reuse existing models when possible before creating new ones
- Make minimal changes to address requests
- One metrics view per model unless there's a clear reason for multiple
- Review existing project resources before making changes

## Security

- Store credentials in environment variables (`.env` or `rill env`), never commit them
- Use secret stores or CI secrets for production credentials

## Performance

- Sample large sources for local development
- Push filters down to the source when supported
- Materialize expensive or frequently queried transformations
- Aggregate early in the pipeline

**Example**: Instead of querying 1B raw events locally:
```sql
-- models/events_sample.sql
SELECT * FROM read_parquet('s3://events/*.parquet')
LIMIT 100000  -- Sample for local dev
```

## Data Quality

- Add tests for critical pipelines (see models with `tests:` blocks)
- Validate schema changes before deploying
- Document non-obvious transformations

**Example test in model YAML**:
```yaml
tests:
  - name: no_null_ids
    expression: user_id IS NOT NULL
```

## Code Clarity

- Prefer clear, maintainable code over micro-optimizations
- Add comments for complex business logic
- Use descriptive names (see code-style.mdc)
